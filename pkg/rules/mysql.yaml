rules:
  - name: MySQL Senstive Connection String
    id: ghost.mysql.1
    description: MySQL connection string with credentials.
    tags:
      - api
      - mysql
    pattern: |
      (?x)
        \b
          (
            (?i)mysql://\w*:[A-Z0-9-_+=]*@\w*[:]?[\d]{0,5}[/]?\w*
          )
        \b
    entropy: 4.1
    redact: [20, 8]
    tests:
      assert:
        - 'export MYSQL_URL="mysql://user:2eaIDdfU8qCZcUp@host:3306/database"'
        - 'export MYSQL_URL="mysql://user:2eaIDdfU8qCZcUp@host:3306"'
        - 'export MYSQL_URL="mysql://user:2eaIDd-fU8qCZcUp@host:3306/database"'
        - 'export MYSQL_URL="mysql://user:2eaIDd-fU8q+CZcUp@host:3306/database"'
        - 'export MYSQL_URL="mysql://user:2eaIDd-fU8q+CZ=cUp@host:3306/database"'
        - 'export MYSQL_URL="mysql://user:2eaIDd-fU8q+CZ=cUp@host/database"'
      assert_not:
        - 'export MYSQL_URL="http://user:2eaIDdfU8qCZcUp@host/v1/users"'
    history:
      - 2025-08-16 initial version
    refs:
      - https://dev.mysql.com/doc/refman/8.0/en/connecting.html
