rules:
  - name: Fastly API Key
    id: ghost.fastly.1
    description: Fastly API key.
    tags:
      - api
      - fastly
    pattern: |
      (?x)
        \b
          (
            (?i)fastly\w*(?:token|key|secret)\w*
            [\W]{0,40}?
            [A-Z0-9_-]{32}
          )
        \b
    entropy: 4.2
    redact: [14, 4]
    tests:
      assert:
        - 'export FASTLY_API_KEY=Qv8YpuARexEYBYtyMwNWhCecavPGMyDe'
        - 'export FASTLY_API_KEY="Qv8YpuARexEYBYtyMwNWhCecavPGMyDe"'
        - 'export FASTLY_API_KEY=afylqva5likdxxcpkpzbc7xqwvgp100w'
        - 'export FASTLY_API_KEY=b6ysfir67zhjuephmidf2hvli8hrgdug'
      assert_not:
        - 'export FASTLY_API_KEY=1234567890'
        - 'Fastly-Key: 1234567890'
    history:
      - 2025-08-19 initial version
    refs:
      - https://www.fastly.com/documentation/reference/api/#authentication
