rules:
  - name: Notion API Client Secret
    id: ghost.notion.1
    description: Notion API client secret.
    tags:
      - api
      - notion
    pattern: |
      (?x)
        \b
          (
            (?i)
            notion\w*
            [\W]{0,40}?
            (?-i:secret_)[A-Z0-9]{43}
          )
        \b
    entropy: 4.5
    redact: [14, 4]
    tests:
      assert:
        - 'export NOTION_API_KEY="secret_mRZDNNbL9uKaPytUfmVou1kdBH8emZXegUXLyDN5KWc"'
        - 'export NOTION_API_KEY="secret_1pngNBYt78qcFvZ5Rp9BwgZDOLNhFjvwFQejwR5WzXx"'
        - 'export NOTION_API_KEY="secret_JflrmSX3TJ7DqIOndKxNbsT63hokOBB0keh81x5WjIw"'
      assert_not:
        - 'export NOTION_API_KEY="SECRET_JflrmSX3TJ7DqIOndKxNbsT63hokOBB0keh81x5WjIw"'
        - 'export NOTION_API_KEY=1234567890'
    history:
      - 2025-08-22 initial version
    refs:
      - https://developers.notion.com/reference/authentication
  - name: Notion API Token
    id: ghost.notion.2
    description: Notion API token.
    tags:
      - api
      - notion
    pattern: |
      (?x)
        \b
          (
            (?i)
            notion\w*
            [\W]{0,40}?
            (?-i:ntn_)[A-Z0-9]{40,}
          )
        \b
    entropy: 4.5
    redact: [14, 4]
    tests:
      assert:
        - 'export NOTION_API_KEY="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"'
        - 'export NOTION_API_KEY="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"'
        - 'export NOTION_API_KEY="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"'
      assert_not:
        - 'export NOTION_API_KEY="NTN_616705793736zhoejl6BN49cD7Cu9H5iotB7b5xI5tsgrF"'
        - 'notion_api_key=1234567890'
    history:
      - 2025-08-22 initial version
    refs:
      - https://developers.notion.com/reference/authentication
  - name: Notion OAuth Refresh Token
    id: ghost.notion.3
    description: Notion OAuth refresh token.
    tags:
      - api
      - notion
      - oauth
    pattern: |
      (?x)
        \b
          (
            (?i)notion\w*
            [\W]{0,40}?
            (?-i:nrt_)[A-Z0-9]{40,}
          )
        \b
    entropy: 4.5
    redact: [14, 4]
    tests:
      assert:
        - 'export NOTION_REFRESH_TOKEN="nrt_61670579373J173ADoomQoPCjzjrT0et7oyf9HXaq9kaSG"'
        - 'export NOTION_REFRESH_TOKEN="nrt_616705793733PjqxSzniNzxUYdyfPU468OvaT85M1FgflT"'
        - 'export NOTION_REFRESH_TOKEN="nrt_616705793731dWb6VFzndMNFH98cjUckeQLuBp06qGfcZO"'
      assert_not:
        - 'export NOTION_REFRESH_TOKEN="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"'
        - 'export NOTION_REFRESH_TOKEN="NTN_616705793738HSZVtOKVftobxZf96nkvcyZCD2uIPtg7mA"'
        - 'export NOTION_REFRESH_TOKEN=1234567890'
    history:
      - 2025-08-22 initial version
    refs:
      - https://developers.notion.com/reference/create-a-token
