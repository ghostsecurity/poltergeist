rules:
  - name: Dynatrace API Token
    id: ghost.dynatrace.1
    description: Dynatrace API token.
    tags:
      - api
      - dynatrace
    pattern: |
      (?x)
        \b
          (dt0[a-z]\d{2}\.(?i)[A-Z0-9_-]{24}\.[A-Z0-9_-]{64})
        \b
    entropy: 4.5
    redact: [12, 4]
    tests:
      assert:
        - dt0s01.ST2EY72KQINMH574WMNVI7YN.G3DFPBEJYMODIDAEX454M7YWBUVEFOWKPRVMWFASS64NFH52PX6BNDVFFM572RZM
        - 'dynatrace_api_key=dt0s01.ST2EY72KQINMH574WMNVI7YN.G3DFPBEJYMODIDAEX454M7YWBUVEFOWKPRVMWFASS64NFH52PX6BNDVFFM572RZM'
        - dt0s03.ST2EY72KQINMH574WMNVI7YN.G3DFPBEJYMODIDAEX454M7YWBUVEFOWKPRVMWFASS64NFH52PX6BNDVFFM572RZM
        - dt0s09.ST2EY72KQINMH574WMNVI7YN.G3DFPBEJYMODIDAEX454M7YWBUVEFOWKPRVMWFASS64NFH52PX6BNDVFFM572RZM
      assert_not:
        - dt0s01.ST2EY72KQINMH574WMNVI7YN.G3DFPBEJYMODIDAEX454M7YWBUVEF.OWKPRVMWFASS64NFH52PX6BNDVFFM572RZM
        - dt0s01.ST2EY72KQINMH574WMNVI7YN.G3DFPBEJYMODIDAEX454M7YWBUVEFOWKPRVMWFASS64NFH52PX6BNDVFFM572RZ
        - dt0s001.ST2EY72KQINMH574WMNVI7YN.G3DFPBEJYMODIDAEX454M7YWBUVEFOWKPRVMWFASS64NFH52PX6BNDVFFM572RZM
    history:
      - 2025-08-14 initial version
    refs:
      - https://docs.dynatrace.com/docs/discover-dynatrace/references/dynatrace-api/basics/dynatrace-api-authentication#token-format-prefixes
